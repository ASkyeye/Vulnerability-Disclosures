# CVE-2021-23874

## Description

Insecure DACL of the COM-object "CoManageOem Class" allows an unprivileged attacker to gain access to a privileged 
interface of the service McAWFwk.

## Impact

Local privilege escalation vulnerability in McAfee Total Protection (MTP) prior to 16.0.30 allows a restricted user 
to create and execute arbitrary process in "NT Authority\System" context.

## Steps to reproduce

1. Run *CoManageOemExploit.exe*;
2. Run *PowerShell.exe* and type the following command: *". .\powercat.ps1;powercat -c 127.0.0.1 -p 12345"*;
3. Enjoy SYSTEM privileges!

## Resolution

This issue fixed since version 16.0.30 of MTP.

## Disclosure Timeline

03-11-2020 Initial report sent to McAfee.

04-11-2020 Initial response from McAfee stating theyâ€™re being reviewed it.

24-11-2020 McAfee triaged the issue reported as a valid issue and is starting work on a fix.

10-02-2021 McAfee releases patched version of product and published the security bulletin.

## References

[CVE-2021-23874](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-23874)

[McAfee Security Bulletin](http://service.mcafee.com/FAQDocument.aspx?&id=TS103114)

[Write-Up](https://the-deniss.github.io/posts/2021/05/17/discovering-and-exploiting-mcafee-com-objects.html)
